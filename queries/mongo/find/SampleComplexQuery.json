{
    "collection": "books",
    "query": [
        {
            "$group": {
                "_id": "$BookId",  
                "totalRatings": {"$sum": {"$eq": ["$r.ratings", 4] } }
                
            }
        },
        {
            "$sort": {"totalRatings": -1}  
        },
        {
            "$limit": 1  
        },
        {
            "$set": {
                "tags": { "$concat": ["$tags", ",01_best-books"] }
            }
        }
    ]
}
